"use strict";(self.webpackChunkClientUI=self.webpackChunkClientUI||[]).push([[690],{690:($,p,i)=>{i.r(p),i.d(p,{ProductListingModule:()=>x});var u=i(177),d=i(2461),h=i(1413),m=i(6977),t=i(7705),g=i(5661),y=i(564),v=i(8088),f=i(9141);const I=["scrollSentinel"];function w(s,c){if(1&s){const e=t.RV6();t.j41(0,"div",5)(1,"div",6)(2,"img",7),t.bIt("click",function(){const a=t.eBV(e).$implicit,E=t.XpG();return t.Njj(E.redirectToProduct(null==a?null:a.slug))}),t.k0s()(),t.j41(3,"div",8)(4,"div",9)(5,"p",10),t.EFF(6),t.k0s()(),t.j41(7,"div",9)(8,"span",11),t.EFF(9),t.k0s()()()()}if(2&s){const e=c.$implicit;t.R7$(2),t.Y8G("src",null==e.photos[0]?null:e.photos[0].url,t.B4B),t.R7$(4),t.JRh(e.name),t.R7$(3),t.JRh(e.priceDisplay)}}function P(s,c){1&s&&(t.j41(0,"div",12)(1,"p",13),t.EFF(2,"Kh\xf4ng t\xecm th\u1ea5y s\u1ea3n ph\u1ea9m n\xe0o"),t.k0s()())}let T=(()=>{class s{constructor(e,o){this.productListingService=e,this.router=o,this.collectionId=null,this.queryType="category",this.products=[],this.productParams=new y.O,this.loading=!1,this.error=null,this.hasMoreProducts=!0,this.isLoadingMore=!1,this.totalCount=0,this.observer=null,this.productParams.pageSize=8,this.productParams.pageIndex=1}ngOnDestroy(){this.observer&&(this.observer.disconnect(),this.observer=null)}ngOnInit(){this.loadProducts()}ngAfterViewInit(){this.setupIntersectionObserver()}setupIntersectionObserver(){this.observer&&this.observer.disconnect(),this.observer=new IntersectionObserver(o=>{o.forEach(r=>{r.isIntersecting&&!this.isLoadingMore&&this.hasMoreProducts&&this.loadMoreProducts()})},{root:null,rootMargin:"200px",threshold:.1}),this.scrollSentinel&&this.scrollSentinel.nativeElement&&this.observer.observe(this.scrollSentinel.nativeElement)}ngOnChanges(e){(e.collectionId||e.queryType)&&(this.resetProductsState(),this.loadProducts(),setTimeout(()=>{this.setupIntersectionObserver()},100))}resetProductsState(){this.products=[],this.productParams.pageIndex=1,this.hasMoreProducts=!0,this.totalCount=0,this.isLoadingMore=!1}loadProducts(){switch(this.loading=!0,this.error=null,this.queryType){case"all":case"new-arrivals":this.productParams.typeId=0;break;case"category":this.productParams.typeId=null!==this.collectionId&&0!==this.collectionId?this.collectionId:0}this.productListingService.getProducts(this.productParams).subscribe({next:e=>{this.products=e.data,this.totalCount=e.count,this.loading=!1,this.checkIfHasMore()},error:e=>{console.error("Error loading products:",e),this.error="Kh\xf4ng th\u1ec3 t\u1ea3i s\u1ea3n ph\u1ea9m. Vui l\xf2ng th\u1eed l\u1ea1i sau.",this.loading=!1}})}loadMoreProducts(){this.isLoadingMore||!this.hasMoreProducts||(this.isLoadingMore=!0,this.productParams.pageIndex++,this.productListingService.getProducts(this.productParams).subscribe({next:e=>{this.products=[...this.products,...e.data],this.totalCount=e.count,this.isLoadingMore=!1,this.checkIfHasMore()},error:e=>{console.error("Error loading more products:",e),this.isLoadingMore=!1,this.productParams.pageIndex--}}))}checkIfHasMore(){this.hasMoreProducts=this.products.length<this.totalCount}redirectToProduct(e){this.router.navigate([`products/${e}`])}static{this.\u0275fac=function(o){return new(o||s)(t.rXU(v.V),t.rXU(d.Ix))}}static{this.\u0275cmp=t.VBU({type:s,selectors:[["app-product-items"]],viewQuery:function(o,r){if(1&o&&t.GBs(I,5,t.aKT),2&o){let a;t.mGM(a=t.lsd())&&(r.scrollSentinel=a.first)}},inputs:{collectionId:"collectionId",queryType:"queryType"},features:[t.OA$],decls:5,vars:2,consts:[[1,"tw-grid","tw-grid-cols-2","md:tw-grid-cols-4"],["class","tw-h-[400px] md:tw-h-[757px]",4,"ngFor","ngForOf"],[1,"tw-h-1","tw-w-full"],["scrollSentinel",""],["class","tw-w-full tw-py-8 tw-text-center tw-text-gray-500",4,"ngIf"],[1,"tw-h-[400px]","md:tw-h-[757px]"],[1,"tw-h-[80%]","md:tw-h-[88%]"],["nz-image","",1,"object-fit-cover","w-100","h-100","md:tw-cursor-pointer",3,"src","click"],[1,"tw-h-[20%]","md:tw-h-[12%]","tw-px-3","tw-py-2"],[1,"tw-my-1"],["nz-typography","","nzEllipsis","","nzEllipsisRows","1",1,"tw-text-xs"],[1,"tw-text-xs"],[1,"tw-w-full","tw-py-8","tw-text-center","tw-text-gray-500"],[1,"tw-text-sm"]],template:function(o,r){1&o&&(t.j41(0,"div",0),t.DNE(1,w,10,3,"div",1),t.k0s(),t.nrm(2,"div",2,3),t.DNE(4,P,3,0,"div",4)),2&o&&(t.R7$(1),t.Y8G("ngForOf",r.products),t.R7$(3),t.Y8G("ngIf",!r.loading&&!r.isLoadingMore&&0===r.products.length))},dependencies:[u.Sq,u.bT,f.Di]})}}return s})(),l=(()=>{class s{constructor(e){this.route=e,this.collectionId=null,this.pageTitle="",this.queryType="category",this.destroy$=new h.B}ngOnInit(){this.route.data.pipe((0,m.Q)(this.destroy$)).subscribe(e=>{this.queryType=e.queryType||"category",this.pageTitle=e.pageTitle||"",this.collectionId=e.collectionId??null})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static{this.\u0275fac=function(o){return new(o||s)(t.rXU(d.nX))}}static{this.\u0275cmp=t.VBU({type:s,selectors:[["app-product-listing"]],decls:8,vars:3,consts:[[1,"product-listing-container"],[1,"tw-px-7"],[1,"tw-font-semibold","tw-text-lg"],[1,"tw-mt-4"],[3,"collectionId","queryType"]],template:function(o,r){1&o&&(t.j41(0,"div",0)(1,"div"),t.nrm(2,"app-common-breadcrumb"),t.k0s(),t.j41(3,"div",1)(4,"span",2),t.EFF(5),t.k0s()(),t.j41(6,"div",3),t.nrm(7,"app-product-items",4),t.k0s()()),2&o&&(t.R7$(5),t.JRh(r.pageTitle),t.R7$(2),t.Y8G("collectionId",r.collectionId)("queryType",r.queryType))},dependencies:[g.y,T]})}}return s})();const b=[{path:"all",component:l,data:{breadcrumb:"All Products",pageTitle:"All Products",queryType:"all",collectionId:0}},{path:"new-arrivals",component:l,data:{breadcrumb:"New Arrivals",pageTitle:"New Arrivals",queryType:"new-arrivals",collectionId:null}},{path:"tops",component:l,data:{breadcrumb:"Tops",pageTitle:"Tops",queryType:"category",collectionId:1}},{path:"bottoms",component:l,data:{breadcrumb:"Bottoms",pageTitle:"Bottoms",queryType:"category",collectionId:2}},{path:"dresses",component:l,data:{breadcrumb:"Dresses",pageTitle:"Dresses",queryType:"category",collectionId:3}}];let C=(()=>{class s{static{this.\u0275fac=function(o){return new(o||s)}}static{this.\u0275mod=t.$C({type:s})}static{this.\u0275inj=t.G2t({imports:[d.iI.forChild(b),d.iI]})}}return s})();var M=i(9863);let x=(()=>{class s{static{this.\u0275fac=function(o){return new(o||s)}}static{this.\u0275mod=t.$C({type:s})}static{this.\u0275inj=t.G2t({imports:[u.MD,C,M.U]})}}return s})()}}]);